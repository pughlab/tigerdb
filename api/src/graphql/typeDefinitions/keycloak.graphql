scalar Email

type KeycloakUser {
  keycloakUserID: ID!
  name: String!
  email: Email!
  roles: [String]
  notifications: [Notification!]! @relationship(type: "RECEIVED_NOTIFICATION", direction: IN)
  sentMessages: [Message!] @relationship(type: "SENT_BY", direction: OUT)
}

type Mutation {
    me: KeycloakUser @auth
}

extend type KeycloakUser @auth(
  rules: [{
      isAuthenticated: true,
      # where: {allowedRoles: "$jwt.realm_access.roles"}
      where: {AND: [
        # {allowedStudies: "$jwt.resource_access.pibu-app.roles"},
        # {allowedSites: "$jwt.resource_access.pibu-app.roles"},
        {allowedRoles: "$jwt.resource_access.pibu-app.roles"},
        ]}
    }]
)